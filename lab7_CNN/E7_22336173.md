# **ä¸­å±±å¤§å­¦è®¡ç®—æœºå­¦é™¢** **æœ¬ç§‘ç”Ÿå®žéªŒæŠ¥å‘Š**ï¼ˆ2023å­¦å¹´æ˜¥å­£å­¦æœŸï¼‰

## è¯¾ç¨‹åç§°ï¼šArtificial Intelligence **äººå·¥æ™ºèƒ½**

| æ•™å­¦ç­çº§        |      | ä¸“ä¸šï¼ˆæ–¹å‘ï¼‰ |      |
| --------------- | ---- | ------------ | ---- |
| å­¦å·  2233 6173 |      | å§“å  ç½—å¼˜æ° |      |

## å®žéªŒé¢˜ç›®

![image-20240518170351180](C:\Users\rogers\AppData\Roaming\Typora\typora-user-images\image-20240518170351180.png)

## å®žéªŒå†…å®¹

- ç®—æ³•åŽŸç†

  â€‹	å·ç§¯ç¥žç»ç½‘ç»œæ˜¯ç¥žç»ç½‘ç»œçš„ä¸€ç§ï¼Œè¯¥ç®—æ³•ç”¨äºŽè¯†åˆ«æ•°æ®ä¸­çš„æ¨¡å—ï¼Œç¥žç»ç½‘ç»œæ€»ä½“ä¸Šæ‘å’‹iyuæ¯ä¸€å±‚çš„ç¥žç»å…ƒä¸­ï¼Œä¼´éšä»–ä»¬çš„å­¦ä¹ å‚æ•°å’Œåç½®ï¼ŒCNNå¯åˆ†ä¸ºä¸åŒçš„æ¨¡å—ï¼š

  1.**è¾“å…¥å±‚(INPUT)**ï¼šç”¨äºŽæ•°æ®çš„è¾“å…¥ã€‚
  å½“è¾“å…¥ä¸€å¼ 32*32çš„jpgå›¾ç‰‡çš„æ—¶å€™ï¼Œè¾“å…¥å±‚èƒ½è¯»å–åˆ°32*32*3çš„çŸ©é˜µï¼Œ3æ˜¯å®ƒçš„æ·±åº¦ï¼ˆå³Rã€Gã€Bï¼‰ã€‚

  2.å·ç§¯å±‚ï¼Œæ¿€æ´»å±‚ï¼Œæ± åŒ–å±‚

  **å·ç§¯å±‚**(CONV)ï¼šä½¿ç”¨å·ç§¯æ ¸è¿›è¡Œç‰¹å¾æå–å’Œç‰¹å¾æ˜ å°„ã€‚
  æœºå™¨å­¦ä¹ è¯†åˆ«å›¾ç‰‡çš„è¿‡ç¨‹ä¸­ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸‹å­æ•´å¼ å›¾åŒæ—¶è¯†åˆ«ï¼Œè€Œæ˜¯å¯¹äºŽå›¾ç‰‡ä¸­çš„æ¯ä¸€ä¸ªç‰¹å¾é¦–å…ˆå±€éƒ¨æ„ŸçŸ¥ï¼Œç„¶åŽæ›´é«˜å±‚æ¬¡å¯¹å±€éƒ¨è¿›è¡Œç»¼åˆæ“ä½œï¼Œä»Žè€Œå¾—åˆ°å…¨å±€ä¿¡æ¯ã€‚
  **æ¿€åŠ±å±‚**ï¼šç”±äºŽå·ç§¯ä¹Ÿæ˜¯ä¸€ç§çº¿æ€§è¿ç®—ï¼Œå› æ­¤éœ€è¦å¢žåŠ éžçº¿æ€§æ˜ å°„ã€‚
  æ‰€è°“æ¿€åŠ±ï¼Œå®žé™…ä¸Šæ˜¯å¯¹å·ç§¯å±‚çš„è¾“å‡ºç»“æžœåšä¸€æ¬¡éžçº¿æ€§æ˜ å°„ã€‚
  ã€€ã€€å¦‚æžœä¸ç”¨æ¿€åŠ±å‡½æ•°ï¼ˆå…¶å®žå°±ç›¸å½“äºŽæ¿€åŠ±å‡½æ•°æ˜¯f(x)=xï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸€å±‚çš„è¾“å‡ºéƒ½æ˜¯ä¸Šä¸€å±‚è¾“å…¥çš„çº¿æ€§
  å‡½æ•°ã€‚å®¹æ˜“å¾—å‡ºï¼Œæ— è®ºæœ‰å¤šå°‘ç¥žç»ç½‘ç»œå±‚ï¼Œè¾“å‡ºéƒ½æ˜¯è¾“å…¥çš„çº¿æ€§ç»„åˆï¼Œä¸Žæ²¡æœ‰éšå±‚çš„æ•ˆæžœæ˜¯ä¸€æ ·çš„ï¼Œè¿™å°±æ˜¯æœ€åŽŸ
  å§‹çš„æ„ŸçŸ¥æœºäº†ã€‚
  å¸¸ç”¨çš„æ¿€åŠ±å‡½æ•°æœ‰ï¼š

  Sigmoid
  Tanh
  ReLU
  Leaky ReLU
  ELU
  Maxout
  æ¿€åŠ±å‡½æ•°å»ºè®®ï¼šé¦–å…ˆReLUï¼Œå› ä¸ºè¿­ä»£é€Ÿåº¦å¿«ï¼Œä½†æ˜¯æœ‰å¯èƒ½æ•ˆæžœä¸åŠ ã€‚å¦‚æžœReLUå¤±æ•ˆçš„æƒ…å†µä¸‹ï¼Œè€ƒè™‘ä½¿ç”¨
  Leaky ReLUæˆ–è€…Maxoutï¼Œæ­¤æ—¶ä¸€èˆ¬æƒ…å†µéƒ½å¯ä»¥è§£å†³ã€‚Tanhå‡½æ•°åœ¨æ–‡æœ¬å’ŒéŸ³é¢‘å¤„ç†æœ‰æ¯”è¾ƒå¥½çš„æ•ˆæžœã€‚
  æ± åŒ–å±‚(POOL)ï¼šè¿›è¡Œä¸‹é‡‡æ ·ï¼Œå¯¹ç‰¹å¾å›¾ç¨€ç–å¤„ç†ï¼Œå‡å°‘æ•°æ®è¿ç®—é‡ã€‚
  æ± åŒ–ï¼Œä¹Ÿç§°ä¸ºæ¬ é‡‡æ ·æˆ–ä¸‹é‡‡æ ·ã€‚è¦ç”¨äºŽç‰¹å¾é™ç»´ï¼ŒåŽ‹ç¼©æ•°æ®å’Œå‚æ•°çš„æ•°é‡ï¼Œå‡å°è¿‡æ‹Ÿåˆï¼ŒåŒæ—¶æé«˜æ¨¡åž‹çš„å®¹é”™æ€§ã€‚

  **æ± åŒ–å±‚**

  ä¸ºäº†å‡å°ç‰¹å¾å›¾çš„å°ºå¯¸å¹¶æå–æ›´åŠ æŠ½è±¡çš„ç‰¹å¾ï¼Œå·ç§¯å±‚é€šå¸¸ä¸Žæ± åŒ–å±‚ï¼ˆPooling Layerï¼‰ç»“åˆä½¿ç”¨ã€‚æ± åŒ–å±‚é€šè¿‡å¯¹ç‰¹å¾å›¾è¿›è¡Œé™é‡‡æ ·æ“ä½œï¼Œå‡å°‘è®¡ç®—é‡å¹¶å¢žå¼ºç‰¹å¾çš„å¹³ç§»ä¸å˜æ€§ã€‚

  **å…¨è¿žæŽ¥å±‚(FC)**ï¼šä¹Ÿç§°å®ƒä¸ºè¾“å‡ºå±‚ï¼Œä¹Ÿç§°å®ƒä¸ºè¾“å‡ºå±‚ï¼Œç”¨äºŽè¾“å‡ºå·ç§¯è®¡ç®—åŽçš„ç»“æžœã€‚
  ç»è¿‡å‰é¢è‹¥å¹²æ¬¡å·ç§¯+æ¿€åŠ±+æ± åŒ–åŽï¼Œç»ˆäºŽæ¥åˆ°äº†è¾“å‡ºå±‚ï¼Œæ¨¡åž‹ä¼šå°†å­¦åˆ°çš„ä¸€ä¸ªé«˜è´¨é‡çš„ç‰¹å¾å›¾ç‰‡å…¨è¿žæŽ¥å±‚ã€‚å…¶å®žåœ¨å…¨è¿žæŽ¥å±‚ä¹‹å‰ï¼Œå¦‚æžœç¥žç»å…ƒæ•°ç›®è¿‡å¤§ï¼Œå­¦ä¹ èƒ½åŠ›å¼ºï¼Œæœ‰å¯èƒ½å‡ºçŽ°è¿‡æ‹Ÿåˆã€‚å› æ­¤ï¼Œå¯ä»¥å¼•å…¥dropoutæ“ä½œï¼Œæ¥éšæœºåˆ é™¤ç¥žç»ç½‘ç»œä¸­çš„éƒ¨åˆ†ç¥žç»å…ƒï¼Œæ¥è§£å†³æ­¤é—®é¢˜ã€‚è¿˜å¯ä»¥è¿›è¡Œå±€éƒ¨å½’ä¸€åŒ–ï¼ˆLRNï¼‰ã€æ•°æ®å¢žå¼ºç­‰æ“ä½œï¼Œæ¥å¢žåŠ é²æ£’æ€§ã€‚

- æµç¨‹å›¾

  ![å·ç§¯ç¥žç»ç½‘ç»œï¼ˆCNNï¼‰åŽŸç†åŠåº”ç”¨ - çŸ¥ä¹Ž](https://pic3.zhimg.com/v2-2140eb4a0e0fe56c38add63f1ba3e962_r.jpg)

- å…³é”®ä»£ç å±•ç¤ºï¼ˆå¸¦æ³¨é‡Šï¼‰

  ä½¿ç”¨pytorchæ¡†æž¶

  ```python
  
  class SimpleCNN(nn.Module):#tensor shape: (batch_size, channels, H, W)
      def __init__(self):
          super(SimpleCNN, self).__init__()
          self.conv1 = nn.Sequential( 
              nn.Conv2d(in_channels=3, out_channels=16, kernel_size=5, stride=1, padding=2), # 32 16 224 224
              nn.ReLU(),
              nn.MaxPool2d(kernel_size=4)
          ) #32 16 56 56 
  
          self.conv2 = nn.Sequential(
              nn.Conv2d(in_channels=16, out_channels=32, kernel_size=5, stride=1, padding=2), #32 32 56 56
              nn.ReLU(),
              nn.MaxPool2d(kernel_size=4)
          ) #32 32 14 14
  
          self.conv3 = nn.Sequential(
              nn.Conv2d(in_channels=32, out_channels=64, kernel_size=5, stride=1, padding=2), # 32 64 7 7weis
              nn.ReLU(),
              nn.MaxPool2d(2)
          ) #32 64 7 7
  
          self.out = nn.Linear(64 * 7 * 7, 5)  # Adjusted to 5 classes
  
      def forward(self, x):# input x:3 *224 *224
          x = self.conv1(x)
          x = self.conv2(x)
          x = self.conv3(x)
          x = x.view(x.size(0), -1)# Flatten the tensorï¼Œ output batch*(64*7*7)
          x = self.out(x) # output shape: (batch_size, 5)
          return x
  
  ```

  â€‹	ç½‘ç»œæ¡†æž¶ç®€ä»‹ï¼šä½¿ç”¨äº†3ä¸ªå·ç§¯å±‚ï¼ˆåŒ…å«Reluæ¿€æ´»å’ŒMaxæ± åŒ–å±‚ï¼‰ï¼Œ1ä¸ªå…¨è¿žæŽ¥å±‚

  ç¬¬ä¸€ä¸ªå·ç§¯æ¨¡å—ï¼š

  - **è¾“å…¥é€šé“æ•°**ï¼š3ï¼ˆå‡è®¾è¾“å…¥å›¾åƒæ˜¯RGBå›¾åƒï¼‰ã€‚
  - **è¾“å‡ºé€šé“æ•°**ï¼š16ã€‚
  - **å·ç§¯æ ¸å¤§å°**ï¼š5x5ã€‚
  - **æ­¥å¹…**ï¼š1ã€‚
  - **å¡«å……**ï¼š2ï¼ˆä½¿å¾—å·ç§¯æ“ä½œåŽè¾“å‡ºçš„ç©ºé—´å°ºå¯¸ä¸å˜ï¼‰ã€‚(è¾“å‡ºå°ºå¯¸=âŒŠæ­¥å¹…è¾“å…¥å°ºå¯¸+2Ã—å¡«å……âˆ’å·ç§¯æ ¸å°ºå¯¸âŒ‹+1)
  - **æ¿€æ´»å‡½æ•°**ï¼šReLUã€‚
  - **æœ€å¤§æ± åŒ–**ï¼š4x4ï¼ˆå°†ç‰¹å¾å›¾å°ºå¯¸å‡å°‘åˆ°1/4ï¼‰

  ç¬¬äºŒä¸ªå·ç§¯æ¨¡å—ï¼š

  - **è¾“å…¥é€šé“æ•°**ï¼š16ï¼ˆæ¥è‡ªå‰ä¸€å±‚çš„è¾“å‡ºï¼‰ã€‚
  - **è¾“å‡ºé€šé“æ•°**ï¼š32ã€‚
  - **å·ç§¯æ ¸å¤§å°**ï¼š5x5ã€‚
  - **æ­¥å¹…**ï¼š1ã€‚
  - **å¡«å……**ï¼š2ã€‚
  - **æ¿€æ´»å‡½æ•°**ï¼šReLUã€‚
  - **æœ€å¤§æ± åŒ–**ï¼š4x4

  ç¬¬ä¸‰ä¸ªå·ç§¯æ¨¡å—ï¼š

  - **è¾“å…¥é€šé“æ•°**ï¼š32ï¼ˆæ¥è‡ªå‰ä¸€å±‚çš„è¾“å‡ºï¼‰ã€‚
  - **è¾“å‡ºé€šé“æ•°**ï¼š64ã€‚
  - **å·ç§¯æ ¸å¤§å°**ï¼š5x5ã€‚
  - **æ­¥å¹…**ï¼š1ã€‚
  - **å¡«å……**ï¼š2ã€‚
  - **æ¿€æ´»å‡½æ•°**ï¼šReLUã€‚
  - **æœ€å¤§æ± åŒ–**ï¼š2x2ã€‚

  å…¨è¿žæŽ¥å±‚ï¼š

  - **è¾“å…¥ç‰¹å¾æ•°**ï¼š64 * 7 * 7ï¼ˆç”±æœ€åŽä¸€ä¸ªå·ç§¯å±‚çš„è¾“å‡ºå±•å¹³å¾—åˆ°ï¼‰ã€‚
  - **è¾“å‡ºç‰¹å¾æ•°**ï¼š5ï¼ˆå‡è®¾æœ‰5ä¸ªç±»åˆ«è¿›è¡Œåˆ†ç±»ï¼‰ã€‚

  ```python
  for i, data in enumerate(trainloader, 0):
              inputs, labels = data
              inputs, labels = inputs.to(device), labels.to(device) # Move the input and label tensors to the GPU
  
              # Verify the range of labels
              if not torch.all((labels >= 0) & (labels < 5)): 
                  print(f"Label out of bounds detected: {labels}")
                  continue
  
              optimizer.zero_grad()
              outputs = model(inputs)
              loss = criterion(outputs, labels)
              loss.backward() # Backpropagation: compute the gradient of the loss with respect to model parameters
              optimizer.step()
  
              running_loss += loss.item()
              if i % 100 == 99:   # Print every 100 mini-batches
                  print(f'Epoch {epoch + 1}, Batch {i + 1}, Loss: {running_loss / 100:.3f}')
                  running_loss = 0.0
  
          # Append the average loss for the epoch
          train_losses.append(running_loss / len(trainloader))
  
          # Evaluate on test set
          model.eval()
          correct = 0
          total = 0 #
          with torch.no_grad():
              for data in testloader:
                  images, labels = data
                  images, labels = images.to(device), labels.to(device)
                  outputs = model(images)
                  _, predicted = torch.max(outputs.data, 1) #
                  total += labels.size(0)
                  correct += (predicted == labels).sum().item()
          
          accuracy = 100 * correct / total
          test_accuracies.append(accuracy)
  ```

  â€‹	ä¸‹é¢ç®€è¦ä»‹ç»ä½¿ç”¨çš„ä¼˜åŒ–å™¨å’ŒæŸå¤±å‡½æ•°

  optimizer:   Adamä¼˜åŒ–å™¨é€šè¿‡**ç»“åˆåŠ¨é‡å’Œè‡ªé€‚åº”å­¦ä¹ çŽ‡è°ƒæ•´**çš„æ–¹å¼ï¼Œèƒ½å¤Ÿåœ¨è®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡åž‹æ—¶æä¾›é«˜æ•ˆä¸”ç¨³å®šçš„ä¼˜åŒ–æ•ˆæžœã€‚å®ƒæ˜¯ç›®å‰æ·±åº¦å­¦ä¹ ä¸­å¹¿æ³›ä½¿ç”¨çš„ä¼˜åŒ–ç®—æ³•ä¹‹ä¸€ï¼Œé€šå¸¸èƒ½å¤Ÿå¿«é€Ÿåœ°æ”¶æ•›åˆ°è¾ƒå¥½çš„å±€éƒ¨æœ€ä¼˜è§£ã€‚ï¼ˆæ˜¯å¯¹æ™®é€šæ¢¯åº¦ä¸‹é™æ³•çš„å­¦ä¹ çŽ‡è‡ªä¼˜åŒ–ï¼‰ï¼ˆåˆå§‹å­¦ä¹ çŽ‡ä¸ºlr =0.01ï¼‰

  loss å‡½æ•°ï¼šä½¿ç”¨çš„æ˜¯äº¤å‰ç†µæŸå¤±å‡½æ•°

  ###### æ•°å­¦å®šä¹‰

  å‡è®¾æœ‰ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œè¾“å…¥æ•°æ® ð‘¥**x** ç»è¿‡ç¥žç»ç½‘ç»œæ¨¡åž‹å¾—åˆ°é¢„æµ‹çš„ç±»åˆ«æ¦‚çŽ‡åˆ†å¸ƒ ð‘=(ð‘1,ð‘2,â€¦,ð‘ð¶)**p**=(*p*1,*p*2,â€¦,*p**C*)ï¼Œå…¶ä¸­ ð¶*C* æ˜¯ç±»åˆ«æ•°ç›®ã€‚äº¤å‰ç†µæŸå¤±å‡½æ•°çš„è®¡ç®—å…¬å¼ä¸ºï¼š
  $$
  corss-entropy-loss=\sum_{i=1}^{C}q_ilog(pi)
  $$
  â€‹	å…¶ä¸­Cæ˜¯ç±»åˆ«çš„æ•°ç›®ï¼Œqiæ˜¯è¯¥å›¾åƒçš„çœŸå®žç±»åˆ«çš„one_hotç¼–ç ï¼Œ piæ˜¯æ¨¡åž‹ç»™å‡ºçš„å±žäºŽiç±»çš„æ¦‚çŽ‡ï¼Œ

  å½“è¿™ä¸ªæŸå¤±å‡½æ•°è¶Šå°ï¼Œé¢„æµ‹è¶Šå‡†ç¡®ã€‚

  äº¤å‰ç†µæŸå¤±å‡½æ•°æ˜¯æ·±åº¦å­¦ä¹ ä¸­å¸¸ç”¨çš„ä¸€ç§æŸå¤±å‡½æ•°ï¼Œé€‚ç”¨äºŽå¤šç±»åˆ«åˆ†ç±»ä»»åŠ¡ã€‚å®ƒèƒ½å¤Ÿè¡¡é‡æ¨¡åž‹é¢„æµ‹çš„æ¦‚çŽ‡åˆ†å¸ƒä¸Žå®žé™…æ ‡ç­¾ä¹‹é—´çš„å·®å¼‚ï¼Œé€šè¿‡æœ€å°åŒ–äº¤å‰ç†µæŸå¤±æ¥ä¼˜åŒ–ç¥žç»ç½‘ç»œæ¨¡åž‹ï¼Œä»Žè€Œæå‡åˆ†ç±»ä»»åŠ¡çš„å‡†ç¡®æ€§å’Œæ•ˆçŽ‡ã€‚

## å®žéªŒç»“æžœåŠåˆ†æž

1\. å®žéªŒç»“æžœå±•ç¤ºç¤ºä¾‹ï¼ˆå¯å›¾å¯è¡¨å¯æ–‡å­—ï¼Œå°½é‡å¯è§†åŒ–ï¼‰

```python
if os.path.exists('predictions'):
                    shutil.rmtree('predictions')
                if num_epochs == epoch + 1: # Save the predictions only for the last epoch
                    for j in range(len(images)):
                        img_path = testloader.dataset.samples[j][0]
                        img_name = os.path.basename(img_path)
                        predicted_class = classes[predicted[j]]
                        true_class = classes[labels[j]]
                        save_dir = os.path.join('predictions', predicted_class) # Save the predictions in a folder structure
                        os.makedirs(save_dir, exist_ok=True)
                        # copy the src file to the dst folder
                        # Copy original image to prediction folder
                        shutil.copy(img_path, os.path.join(save_dir, img_name))
                        with open(os.path.join(save_dir, f"{img_name}.txt"), 'w') as f:
                            f.write(f"Predicted class: {predicted_class}\n")
                            f.write(f"Confidence: {torch.softmax(outputs[j], dim=0)[predicted[j]].item():.4f}\n")
                            f.write(f"True class: {true_class}\n")
```

â€‹	ä½¿ç”¨ä»¥ä¸Šä»£ç ä¿å­˜é¢„æµ‹æ•ˆæžœå’Œå¤åˆ¶é¢„æµ‹çš„å›¾ç‰‡åˆ°æ¯ä¸€ä¸ªé¢„æµ‹æ–‡ä»¶å¤¹

![image-20240524212616058](C:\Users\rogers\AppData\Roaming\Typora\typora-user-images\image-20240524212616058.png)

â€‹	åœ¨txtæ–‡ä»¶å¤¹ä¸­ä¼šå±•ç¤ºé¢„æµ‹çš„æ¦‚çŽ‡å’ŒçœŸæ˜¯ç±»åˆ«

```
#from R.jpg.txt
Predicted class: jinyinhua
Confidence: 0.9988
True class: jinyinhua
```

2\. è¯„æµ‹æŒ‡æ ‡å±•ç¤ºåŠåˆ†æžï¼ˆæœºå™¨å­¦ä¹ å®žéªŒå¿…é¡»æœ‰æ­¤é¡¹ï¼Œå…¶å®ƒå¯åˆ†æžè¿è¡Œæ—¶é—´ç­‰ï¼‰

â€‹	è®­ç»ƒæŸå¤±çŽ‡éšepochå˜åŒ–å¦‚ä¸‹

![image-20240524212329976](C:\Users\rogers\AppData\Roaming\Typora\typora-user-images\image-20240524212329976.png)

***

â€‹	å¯ä»¥çœ‹åˆ°æµ‹è¯•å‡†ç¡®çŽ‡å¤§ä½“ä¸Šéšç€epochæé«˜è€Œæé«˜ï¼Œæœ€ç»ˆè¾¾åˆ°93%å·¦å³![image-20240524212501537](C:\Users\rogers\AppData\Roaming\Typora\typora-user-images\image-20240524212501537.png)

![image-20240524212337651](C:\Users\rogers\AppData\Roaming\Typora\typora-user-images\image-20240524212337651.png)



## 

PSï¼šå¯ä»¥è‡ªå·±è®¾è®¡æŠ¥å‘Šæ¨¡æ¿ï¼Œä½†æ˜¯å†…å®¹å¿…é¡»åŒ…æ‹¬ä¸Šè¿°çš„å‡ ä¸ªéƒ¨åˆ†ï¼Œä¸éœ€è¦å†™å®žéªŒæ„Ÿæƒ³
